<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accessories Adda Invoice Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
</head>
<body class="bg-light">

<div class="container my-4">
  <h2 class="text-center text-danger mb-4">Accessories Adda - Invoice Generator</h2>

  <!-- Invoice Form -->
  <form id="invoiceForm" class="card p-4 shadow-lg">
    <div class="row mb-3">
      <div class="col-md-4">
        <label class="form-label">Invoice No</label>
        <input type="text" class="form-control" id="invoiceNo" required>
      </div>
      <div class="col-md-4">
        <label class="form-label">Invoice Date</label>
        <input type="date" class="form-control" id="invoiceDate" required>
      </div>
      <div class="col-md-4">
        <label class="form-label">Customer Name</label>
        <input type="text" class="form-control" id="customerName" required>
      </div>
    </div>

    <!-- Bill To / Ship To -->
    <h5 class="mt-3">Bill To / Ship To</h5>
    <div class="row mb-3">
      <div class="col-md-6">
        <h6>Bill To</h6>
        <input type="text" class="form-control mb-2" id="billName" placeholder="Customer Name" required>
        <input type="text" class="form-control mb-2" id="billAddress" placeholder="Address" required>
        <input type="text" class="form-control mb-2" id="billMobile" placeholder="Mobile Number" required>
        <input type="text" class="form-control mb-2" id="billAltMobile" placeholder="Alternate Number">
        <input type="email" class="form-control mb-2" id="billEmail" placeholder="Email">
      </div>

      <div class="col-md-6">
        <h6>Ship To</h6>
        <input type="text" class="form-control mb-2" id="shipName" placeholder="Customer Name" required>
        <input type="text" class="form-control mb-2" id="shipAddress" placeholder="Address" required>
        <input type="text" class="form-control mb-2" id="shipMobile" placeholder="Mobile Number" required>
        <input type="text" class="form-control mb-2" id="shipAltMobile" placeholder="Alternate Number">
        <input type="email" class="form-control mb-2" id="shipEmail" placeholder="Email">
      </div>
    </div>

    <!-- Products -->
    <h5 class="mt-3">Products</h5>
    <table class="table table-bordered" id="productsTable">
      <thead>
        <tr>
          <th>Item</th>
          <th>Quantity</th>
          <th>Price Per Unit</th>
          <th>Amount</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="productsBody">
        <tr>
          <td><input type="text" class="form-control" name="item[]" required></td>
          <td><input type="number" class="form-control" name="qty[]" required></td>
          <td><input type="number" class="form-control" name="price[]" required></td>
          <td><input type="number" class="form-control" name="amount[]" readonly></td>
          <td><button type="button" class="btn btn-danger btn-sm removeRow">X</button></td>
        </tr>
      </tbody>
    </table>
    <button type="button" class="btn btn-success mb-3" id="addRow">+ Add Product</button>

    <!-- Discount -->
    <div class="row mb-3">
      <div class="col-md-4">
        <label class="form-label">Discount (%)</label>
        <input type="number" class="form-control" id="discount" value="0">
      </div>
    </div>

    <!-- Terms -->
    <div class="row mb-3">
      <div class="col-md-12">
        <label class="form-label">Terms & Conditions</label>
        <textarea class="form-control" id="terms" rows="5">
Warranty Products:
1. All items come with standard warranty if mentioned.
2. Returns accepted within 7 days for damaged products only.

Without Warranty Products:
1. No returns or exchanges allowed.
2. Seller not responsible for misuse or third-party damage.
3. Prices and stock may change without notice.
        </textarea>
      </div>
    </div>

    <button type="button" class="btn btn-primary w-100" onclick="generateInvoice()">Generate Invoice PDF</button>
  </form>
</div>

<script>
  // Add Product Row
  document.getElementById("addRow").addEventListener("click", () => {
    let row = `
      <tr>
        <td><input type="text" class="form-control" name="item[]" required></td>
        <td><input type="number" class="form-control" name="qty[]" required></td>
        <td><input type="number" class="form-control" name="price[]" required></td>
        <td><input type="number" class="form-control" name="amount[]" readonly></td>
        <td><button type="button" class="btn btn-danger btn-sm removeRow">X</button></td>
      </tr>`;
    document.getElementById("productsBody").insertAdjacentHTML("beforeend", row);
  });

  // Remove Row
  document.addEventListener("click", e => {
    if (e.target.classList.contains("removeRow")) {
      e.target.closest("tr").remove();
    }
  });

  // Generate Invoice PDF
  function generateInvoice() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF("p", "mm", "a4");

    // Header
    doc.setFontSize(16);
    doc.setTextColor(200,0,0);
    doc.text("Accessories Adda", 14, 15);
    doc.setFontSize(10);
    doc.setTextColor(0,0,0);
    doc.text("Jail Road, Indore, Madhya Pradesh", 14, 22);
    doc.text("Phone: +91 9770274616", 14, 28);
    doc.setFontSize(14);
    doc.text("Cash Invoice", 150, 15);

    // Invoice info
    doc.setFontSize(10);
    doc.text(`Invoice No: ${document.getElementById("invoiceNo").value}`, 150, 22);
    doc.text(`Invoice Date: ${document.getElementById("invoiceDate").value}`, 150, 28);

    // Bill To / Ship To Table
    let billTo = [
      ["Name", document.getElementById("billName").value],
      ["Address", document.getElementById("billAddress").value],
      ["Mobile", document.getElementById("billMobile").value],
      ["Alt Mobile", document.getElementById("billAltMobile").value],
      ["Email", document.getElementById("billEmail").value]
    ];
    let shipTo = [
      ["Name", document.getElementById("shipName").value],
      ["Address", document.getElementById("shipAddress").value],
      ["Mobile", document.getElementById("shipMobile").value],
      ["Alt Mobile", document.getElementById("shipAltMobile").value],
      ["Email", document.getElementById("shipEmail").value]
    ];

    doc.autoTable({
      startY: 35,
      head: [['Bill To', 'Ship To']],
      body: [[
        billTo.map(r => r[0] + ": " + r[1]).join("\n"),
        shipTo.map(r => r[0] + ": " + r[1]).join("\n")
      ]],
      theme: 'grid',
      styles: { fontSize: 10, cellPadding: 2 }
    });

    // Products Table
    let products = [];
    let rows = document.querySelectorAll("#productsBody tr");
    let total = 0;

    rows.forEach(row => {
      let item = row.querySelector("input[name='item[]']").value;
      let qty = parseFloat(row.querySelector("input[name='qty[]']").value) || 0;
      let price = parseFloat(row.querySelector("input[name='price[]']").value) || 0;
      let amount = qty * price;
      total += amount;
      row.querySelector("input[name='amount[]']").value = amount;
      products.push([item, qty, price, amount]);
    });

    doc.autoTable({
      startY: doc.lastAutoTable.finalY + 10,
      head: [['Item', 'Quantity', 'Price', 'Amount']],
      body: products,
      theme: 'grid',
      styles: { fontSize: 10 }
    });

    // Totals
    let discount = parseFloat(document.getElementById("discount").value) || 0;
    let discountAmt = (total * discount) / 100;
    let finalAmt = total - discountAmt;

    doc.autoTable({
      startY: doc.lastAutoTable.finalY + 10,
      margin: { left: 120 },
      body: [
        ["Total Amount", total.toFixed(2)],
        ["Discount", discount + "%"],
        ["Discount Value", discountAmt.toFixed(2)],
        ["Final Payable", finalAmt.toFixed(2)]
      ],
      theme: 'grid',
      styles: { fontSize: 10 }
    });

    // Terms & Conditions
    let terms = document.getElementById("terms").value;
    doc.setFontSize(12);
    doc.text("Terms & Conditions:", 14, doc.lastAutoTable.finalY + 20);
    doc.setFontSize(9);
    let lines = doc.splitTextToSize(terms, 180);
    doc.text(lines, 14, doc.lastAutoTable.finalY + 28);

    // Save PDF
    doc.save(`Invoice_${document.getElementById("invoiceNo").value}.pdf`);
  }
</script>

</body>
</html>
